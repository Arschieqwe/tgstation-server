<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tgstation-server: Tgstation.Server.Host.Database.DatabaseSeeder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="tgs.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tgstation-server
   &#160;<span id="projectnumber">4.14.0</span>
   </div>
   <div id="projectbrief">The /tg/station 13 server suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_tgstation.html">Tgstation</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server.html">Server</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server_1_1_host.html">Host</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server_1_1_host_1_1_database.html">Database</a></li><li class="navelem"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Tgstation.Server.Host.Database.DatabaseSeeder Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p> 
 <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Tgstation.Server.Host.Database.DatabaseSeeder:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder__inherit__graph.png" border="0" usemap="#a_tgstation_8_server_8_host_8_database_8_database_seeder_inherit__map" alt="Inheritance graph"/></div>
<map name="a_tgstation_8_server_8_host_8_database_8_database_seeder_inherit__map" id="a_tgstation_8_server_8_host_8_database_8_database_seeder_inherit__map">
<area shape="rect" title=" " alt="" coords="5,80,215,121"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_seeder.html" title="For initially setting up a database." alt="" coords="49,5,171,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Tgstation.Server.Host.Database.DatabaseSeeder:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder__coll__graph.png" border="0" usemap="#a_tgstation_8_server_8_host_8_database_8_database_seeder_coll__map" alt="Collaboration graph"/></div>
<map name="a_tgstation_8_server_8_host_8_database_8_database_seeder_coll__map" id="a_tgstation_8_server_8_host_8_database_8_database_seeder_coll__map">
<area shape="rect" title=" " alt="" coords="844,187,1053,229"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_seeder.html" title="For initially setting up a database." alt="" coords="471,5,594,32"/>
<area shape="rect" title=" " alt="" coords="403,57,662,98"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html" title="Configuration options for the Database.DatabaseContext." alt="" coords="418,122,647,163"/>
<area shape="rect" title=" " alt="" coords="55,64,110,91"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html" title="General configuration options." alt="" coords="418,187,647,229"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html" title="Contains various cryptographic functions." alt="" coords="432,253,633,294"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_internal_1_1_server_information_base.html" title="Base class for Response.ServerInformationResponse." alt="" coords="5,133,160,160"/>
<area shape="rect" title=" " alt="" coords="43,253,122,280"/>
<area shape="rect" title=" " alt="" coords="7,304,159,331"/>
<area shape="rect" title=" " alt="" coords="36,355,129,381"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_platform_identifier.html" title="For identifying the current platform." alt="" coords="433,318,632,359"/>
<area shape="rect" title=" " alt="" coords="401,383,664,425"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aadb06f4dafe423e9545a4e123c5e8abd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aadb06f4dafe423e9545a4e123c5e8abd">DatabaseSeeder</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html">ICryptographySuite</a> <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a88f644df987dce53ffa2e26a763f5974">cryptographySuite</a>, <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_platform_identifier.html">IPlatformIdentifier</a> <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a9b30ce06ad99c07d9405020656cc3a1d">platformIdentifier</a>, IOptions&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a> &gt; generalConfigurationOptions, IOptions&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html">DatabaseConfiguration</a> &gt; databaseConfigurationOptions, ILogger&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_context.html">DatabaseContext</a> &gt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a2bc9f345004fe0cd972d9275d771b948">databaseLogger</a>, ILogger&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a> &gt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">logger</a>)</td></tr>
<tr class="memdesc:aadb06f4dafe423e9545a4e123c5e8abd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a new instance of the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a> class.  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aadb06f4dafe423e9545a4e123c5e8abd">More...</a><br /></td></tr>
<tr class="separator:aadb06f4dafe423e9545a4e123c5e8abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a453f07e4addb58e08b4ce0ddfb84e357"><td class="memItemLeft" align="right" valign="top">async Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a453f07e4addb58e08b4ce0ddfb84e357">Initialize</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a> databaseContext, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a453f07e4addb58e08b4ce0ddfb84e357"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespace_tgstation_1_1_server_1_1_host_1_1_setup.html">Setup</a> up a given <em>databaseContext</em> .  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a453f07e4addb58e08b4ce0ddfb84e357">More...</a><br /></td></tr>
<tr class="separator:a453f07e4addb58e08b4ce0ddfb84e357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae30cd4eb76ba111b3fcd0e1b3622716d"><td class="memItemLeft" align="right" valign="top">Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#ae30cd4eb76ba111b3fcd0e1b3622716d">Downgrade</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a> databaseContext, Version downgradeVersion, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:ae30cd4eb76ba111b3fcd0e1b3622716d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Migrate a given <em>databaseContext</em>  down.  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#ae30cd4eb76ba111b3fcd0e1b3622716d">More...</a><br /></td></tr>
<tr class="separator:ae30cd4eb76ba111b3fcd0e1b3622716d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a58329cfe5297b2569da770f7c05e1fbf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a58329cfe5297b2569da770f7c05e1fbf">SeedAdminUser</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a> databaseContext)</td></tr>
<tr class="memdesc:a58329cfe5297b2569da770f7c05e1fbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a default admin User to a given <em>databaseContext</em> .  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a58329cfe5297b2569da770f7c05e1fbf">More...</a><br /></td></tr>
<tr class="separator:a58329cfe5297b2569da770f7c05e1fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09fc7208df756283dd6b475cfe013151"><td class="memItemLeft" align="right" valign="top">async Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a09fc7208df756283dd6b475cfe013151">SeedDatabase</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a> databaseContext, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a09fc7208df756283dd6b475cfe013151"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initially seed a given <em>databaseContext</em> .  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a09fc7208df756283dd6b475cfe013151">More...</a><br /></td></tr>
<tr class="separator:a09fc7208df756283dd6b475cfe013151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed443f053ba4e1098f0e4099d23b774"><td class="memItemLeft" align="right" valign="top">async Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1ed443f053ba4e1098f0e4099d23b774">SanitizeDatabase</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a> databaseContext, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a1ed443f053ba4e1098f0e4099d23b774"><td class="mdescLeft">&#160;</td><td class="mdescRight">Correct invalid database data caused by previous versions (NOT user fuckery).  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1ed443f053ba4e1098f0e4099d23b774">More...</a><br /></td></tr>
<tr class="separator:a1ed443f053ba4e1098f0e4099d23b774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af844d41153f8a43c071bb6ec67445a1b"><td class="memItemLeft" align="right" valign="top">async Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#af844d41153f8a43c071bb6ec67445a1b">ResetAdminPassword</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a> databaseContext, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:af844d41153f8a43c071bb6ec67445a1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes the admin password in <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html" title="Represents the database.">IDatabaseContext</a> back to it's default, enables the account, and gives it AdministrationRights.WriteUsers access.  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#af844d41153f8a43c071bb6ec67445a1b">More...</a><br /></td></tr>
<tr class="separator:af844d41153f8a43c071bb6ec67445a1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eed27ad5d706f6f3f4c691704205f67"><td class="memItemLeft" align="right" valign="top">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1eed27ad5d706f6f3f4c691704205f67">GetAdminUser</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a> databaseContext, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a1eed27ad5d706f6f3f4c691704205f67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get or create the admin User.  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1eed27ad5d706f6f3f4c691704205f67">More...</a><br /></td></tr>
<tr class="separator:a1eed27ad5d706f6f3f4c691704205f67"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:ad65df3157dcd8d5485b4564fa7f92798"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#ad65df3157dcd8d5485b4564fa7f92798">SeedSystemUser</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a> databaseContext, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a> tgsUser=null)</td></tr>
<tr class="memdesc:ad65df3157dcd8d5485b4564fa7f92798"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a default system User to a given <em>databaseContext</em> .  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#ad65df3157dcd8d5485b4564fa7f92798">More...</a><br /></td></tr>
<tr class="separator:ad65df3157dcd8d5485b4564fa7f92798"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a88f644df987dce53ffa2e26a763f5974"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html">ICryptographySuite</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a88f644df987dce53ffa2e26a763f5974">cryptographySuite</a></td></tr>
<tr class="memdesc:a88f644df987dce53ffa2e26a763f5974"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ICryptographySuite for the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>.  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a88f644df987dce53ffa2e26a763f5974">More...</a><br /></td></tr>
<tr class="separator:a88f644df987dce53ffa2e26a763f5974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b30ce06ad99c07d9405020656cc3a1d"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_platform_identifier.html">IPlatformIdentifier</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a9b30ce06ad99c07d9405020656cc3a1d">platformIdentifier</a></td></tr>
<tr class="memdesc:a9b30ce06ad99c07d9405020656cc3a1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The IPlatformIdentifier for the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>.  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a9b30ce06ad99c07d9405020656cc3a1d">More...</a><br /></td></tr>
<tr class="separator:a9b30ce06ad99c07d9405020656cc3a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bc9f345004fe0cd972d9275d771b948"><td class="memItemLeft" align="right" valign="top">readonly ILogger&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_context.html">DatabaseContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a2bc9f345004fe0cd972d9275d771b948">databaseLogger</a></td></tr>
<tr class="memdesc:a2bc9f345004fe0cd972d9275d771b948"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ILogger used for <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html" title="Represents the database.">IDatabaseContext</a>s.  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a2bc9f345004fe0cd972d9275d771b948">More...</a><br /></td></tr>
<tr class="separator:a2bc9f345004fe0cd972d9275d771b948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf6976bc08dbb6209b8ca16509604a09"><td class="memItemLeft" align="right" valign="top">readonly ILogger&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">logger</a></td></tr>
<tr class="memdesc:aaf6976bc08dbb6209b8ca16509604a09"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ILogger for the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>.  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">More...</a><br /></td></tr>
<tr class="separator:aaf6976bc08dbb6209b8ca16509604a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51341ea00d7cfc1eead8b52235e76257"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a51341ea00d7cfc1eead8b52235e76257">generalConfiguration</a></td></tr>
<tr class="memdesc:a51341ea00d7cfc1eead8b52235e76257"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GeneralConfiguration for the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>.  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a51341ea00d7cfc1eead8b52235e76257">More...</a><br /></td></tr>
<tr class="separator:a51341ea00d7cfc1eead8b52235e76257"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c8e101a216a05b59a646260218b2467"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html">DatabaseConfiguration</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a6c8e101a216a05b59a646260218b2467">databaseConfiguration</a></td></tr>
<tr class="memdesc:a6c8e101a216a05b59a646260218b2467"><td class="mdescLeft">&#160;</td><td class="mdescRight">The DatabaseConfiguration for the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>.  <a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a6c8e101a216a05b59a646260218b2467">More...</a><br /></td></tr>
<tr class="separator:a6c8e101a216a05b59a646260218b2467"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00022">22</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aadb06f4dafe423e9545a4e123c5e8abd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadb06f4dafe423e9545a4e123c5e8abd">&#9670;&nbsp;</a></span>DatabaseSeeder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Tgstation.Server.Host.Database.DatabaseSeeder.DatabaseSeeder </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html">ICryptographySuite</a>&#160;</td>
          <td class="paramname"><em>cryptographySuite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_platform_identifier.html">IPlatformIdentifier</a>&#160;</td>
          <td class="paramname"><em>platformIdentifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IOptions&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a> &gt;&#160;</td>
          <td class="paramname"><em>generalConfigurationOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IOptions&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html">DatabaseConfiguration</a> &gt;&#160;</td>
          <td class="paramname"><em>databaseConfigurationOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ILogger&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_context.html">DatabaseContext</a> &gt;&#160;</td>
          <td class="paramname"><em>databaseLogger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ILogger&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a> &gt;&#160;</td>
          <td class="paramname"><em>logger</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a new instance of the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a> class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cryptographySuite</td><td>The value of <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a88f644df987dce53ffa2e26a763f5974" title="The ICryptographySuite for the DatabaseSeeder.">cryptographySuite</a>.</td></tr>
    <tr><td class="paramname">platformIdentifier</td><td>The value of <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a9b30ce06ad99c07d9405020656cc3a1d" title="The IPlatformIdentifier for the DatabaseSeeder.">platformIdentifier</a>.</td></tr>
    <tr><td class="paramname">generalConfigurationOptions</td><td>The IOptions&lt;TOptions&gt; containing the value of <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a51341ea00d7cfc1eead8b52235e76257" title="The GeneralConfiguration for the DatabaseSeeder.">generalConfiguration</a>.</td></tr>
    <tr><td class="paramname">databaseConfigurationOptions</td><td>The IOptions&lt;TOptions&gt; containing the value of <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a6c8e101a216a05b59a646260218b2467" title="The DatabaseConfiguration for the DatabaseSeeder.">databaseConfiguration</a>.</td></tr>
    <tr><td class="paramname">databaseLogger</td><td>The value of <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a2bc9f345004fe0cd972d9275d771b948" title="The ILogger used for IDatabaseContexts.">databaseLogger</a>.</td></tr>
    <tr><td class="paramname">logger</td><td>The value of <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09" title="The ILogger for the DatabaseSeeder.">logger</a>.</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00088">88</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            this.cryptographySuite = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a88f644df987dce53ffa2e26a763f5974">cryptographySuite</a> ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a88f644df987dce53ffa2e26a763f5974">cryptographySuite</a>));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            this.platformIdentifier = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a9b30ce06ad99c07d9405020656cc3a1d">platformIdentifier</a> ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a9b30ce06ad99c07d9405020656cc3a1d">platformIdentifier</a>));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a6c8e101a216a05b59a646260218b2467">databaseConfiguration</a> = databaseConfigurationOptions?.Value ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(databaseConfigurationOptions));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a51341ea00d7cfc1eead8b52235e76257">generalConfiguration</a> = generalConfigurationOptions?.Value ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(generalConfigurationOptions));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            this.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a2bc9f345004fe0cd972d9275d771b948">databaseLogger</a> = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a2bc9f345004fe0cd972d9275d771b948">databaseLogger</a> ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a2bc9f345004fe0cd972d9275d771b948">databaseLogger</a>));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            this.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">logger</a> = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">logger</a> ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">logger</a>));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_a2bc9f345004fe0cd972d9275d771b948"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a2bc9f345004fe0cd972d9275d771b948">Tgstation.Server.Host.Database.DatabaseSeeder.databaseLogger</a></div><div class="ttdeci">readonly ILogger&lt; DatabaseContext &gt; databaseLogger</div><div class="ttdoc">The ILogger used for IDatabaseContexts.</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00037">DatabaseSeeder.cs:37</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_a51341ea00d7cfc1eead8b52235e76257"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a51341ea00d7cfc1eead8b52235e76257">Tgstation.Server.Host.Database.DatabaseSeeder.generalConfiguration</a></div><div class="ttdeci">readonly GeneralConfiguration generalConfiguration</div><div class="ttdoc">The GeneralConfiguration for the DatabaseSeeder.</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00047">DatabaseSeeder.cs:47</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_a6c8e101a216a05b59a646260218b2467"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a6c8e101a216a05b59a646260218b2467">Tgstation.Server.Host.Database.DatabaseSeeder.databaseConfiguration</a></div><div class="ttdeci">readonly DatabaseConfiguration databaseConfiguration</div><div class="ttdoc">The DatabaseConfiguration for the DatabaseSeeder.</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00052">DatabaseSeeder.cs:52</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_a88f644df987dce53ffa2e26a763f5974"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a88f644df987dce53ffa2e26a763f5974">Tgstation.Server.Host.Database.DatabaseSeeder.cryptographySuite</a></div><div class="ttdeci">readonly ICryptographySuite cryptographySuite</div><div class="ttdoc">The ICryptographySuite for the DatabaseSeeder.</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00027">DatabaseSeeder.cs:27</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_a9b30ce06ad99c07d9405020656cc3a1d"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a9b30ce06ad99c07d9405020656cc3a1d">Tgstation.Server.Host.Database.DatabaseSeeder.platformIdentifier</a></div><div class="ttdeci">readonly IPlatformIdentifier platformIdentifier</div><div class="ttdoc">The IPlatformIdentifier for the DatabaseSeeder.</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00032">DatabaseSeeder.cs:32</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_aaf6976bc08dbb6209b8ca16509604a09"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">Tgstation.Server.Host.Database.DatabaseSeeder.logger</a></div><div class="ttdeci">readonly ILogger&lt; DatabaseSeeder &gt; logger</div><div class="ttdoc">The ILogger for the DatabaseSeeder.</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00042">DatabaseSeeder.cs:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_database_seeder_8cs_source.html#l00027">Tgstation.Server.Host.Database.DatabaseSeeder.cryptographySuite</a>, <a class="el" href="_database_seeder_8cs_source.html#l00052">Tgstation.Server.Host.Database.DatabaseSeeder.databaseConfiguration</a>, <a class="el" href="_database_seeder_8cs_source.html#l00037">Tgstation.Server.Host.Database.DatabaseSeeder.databaseLogger</a>, <a class="el" href="_database_seeder_8cs_source.html#l00047">Tgstation.Server.Host.Database.DatabaseSeeder.generalConfiguration</a>, <a class="el" href="_database_seeder_8cs_source.html#l00042">Tgstation.Server.Host.Database.DatabaseSeeder.logger</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00032">Tgstation.Server.Host.Database.DatabaseSeeder.platformIdentifier</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae30cd4eb76ba111b3fcd0e1b3622716d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae30cd4eb76ba111b3fcd0e1b3622716d">&#9670;&nbsp;</a></span>Downgrade()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Task Tgstation.Server.Host.Database.DatabaseSeeder.Downgrade </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a>&#160;</td>
          <td class="paramname"><em>databaseContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Version&#160;</td>
          <td class="paramname"><em>downgradeVersion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Migrate a given <em>databaseContext</em>  down. </p>

<p>Implements <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_seeder.html#a83bee4040049ba8768dcb04ae7f50deb">Tgstation.Server.Host.Database.IDatabaseSeeder</a>.</p>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00135">135</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">if</span> (databaseContext == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(databaseContext));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">if</span> (downgradeVersion == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(downgradeVersion));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">return</span> databaseContext.SchemaDowngradeForServerVersion(</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a2bc9f345004fe0cd972d9275d771b948">databaseLogger</a>,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                downgradeVersion,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a6c8e101a216a05b59a646260218b2467">databaseConfiguration</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html#adab83eaad53afabdb2f7b43c23ece38a">DatabaseType</a>,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                cancellationToken);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration_html_adab83eaad53afabdb2f7b43c23ece38a"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html#adab83eaad53afabdb2f7b43c23ece38a">Tgstation.Server.Host.Configuration.DatabaseConfiguration.DatabaseType</a></div><div class="ttdeci">DatabaseType DatabaseType</div><div class="ttdoc">The Configuration.DatabaseType to create.</div><div class="ttdef"><b>Definition:</b> <a href="_database_configuration_8cs_source.html#l00020">DatabaseConfiguration.cs:20</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_database_seeder_8cs_source.html#l00052">Tgstation.Server.Host.Database.DatabaseSeeder.databaseConfiguration</a>, <a class="el" href="_database_seeder_8cs_source.html#l00037">Tgstation.Server.Host.Database.DatabaseSeeder.databaseLogger</a>, <a class="el" href="_database_configuration_8cs_source.html#l00020">Tgstation.Server.Host.Configuration.DatabaseConfiguration.DatabaseType</a>, and <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a5529555e7c95208aef1b1c00708f6272">Tgstation.Server.Host.Database.IDatabaseContext.SchemaDowngradeForServerVersion()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ae30cd4eb76ba111b3fcd0e1b3622716d_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ae30cd4eb76ba111b3fcd0e1b3622716d_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ae30cd4eb76ba111b3fcd0e1b3622716d_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ae30cd4eb76ba111b3fcd0e1b3622716d_cgraph">
<area shape="rect" title="Migrate a given databaseContext &#160;down." alt="" coords="5,13,215,54"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a5529555e7c95208aef1b1c00708f6272" title="Attempt to downgrade the schema to the migration used for a given server targetVersion ." alt="" coords="263,5,523,61"/>
</map>
</div>

</div>
</div>
<a id="a1eed27ad5d706f6f3f4c691704205f67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1eed27ad5d706f6f3f4c691704205f67">&#9670;&nbsp;</a></span>GetAdminUser()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt;<a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>&gt; Tgstation.Server.Host.Database.DatabaseSeeder.GetAdminUser </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a>&#160;</td>
          <td class="paramname"><em>databaseContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get or create the admin User. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">databaseContext</td><td>The <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html" title="Represents the database.">IDatabaseContext</a> to use.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task&lt;TResult&gt; resulting in the admin User or <code>null</code>. If <code>null</code>, <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a74e123c6393ad813f997c882a22b228e" title="Saves changes made to the IDatabaseContext.">IDatabaseContext.Save(CancellationToken)</a> must be called on <em>databaseContext</em> .</dd></dl>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00312">312</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            var admin = await databaseContext</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                .Users</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                .AsQueryable()</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                .Where(x =&gt; x.CanonicalName == <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16">CanonicalizeName</a>(<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html">DefaultCredentials</a>.<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html#a92e853a434de557956993046d1b364bb">AdminUserName</a>))</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                .Include(x =&gt; x.CreatedBy)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                .Include(x =&gt; x.PermissionSet)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                .Include(x =&gt; x.Group)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                .FirstOrDefaultAsync(cancellationToken)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                .ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">if</span> (admin == <span class="keywordflow">default</span>)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a58329cfe5297b2569da770f7c05e1fbf">SeedAdminUser</a>(databaseContext);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">return</span> admin;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_default_credentials_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html">Tgstation.Server.Api.DefaultCredentials</a></div><div class="ttdoc">Represents initial credentials used by the server.</div><div class="ttdef"><b>Definition:</b> <a href="_default_credentials_8cs_source.html#l00006">DefaultCredentials.cs:7</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_default_credentials_html_a92e853a434de557956993046d1b364bb"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html#a92e853a434de557956993046d1b364bb">Tgstation.Server.Api.DefaultCredentials.AdminUserName</a></div><div class="ttdeci">static readonly string AdminUserName</div><div class="ttdoc">The name of the default admin user.</div><div class="ttdef"><b>Definition:</b> <a href="_default_credentials_8cs_source.html#l00011">DefaultCredentials.cs:11</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_a58329cfe5297b2569da770f7c05e1fbf"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a58329cfe5297b2569da770f7c05e1fbf">Tgstation.Server.Host.Database.DatabaseSeeder.SeedAdminUser</a></div><div class="ttdeci">User SeedAdminUser(IDatabaseContext databaseContext)</div><div class="ttdoc">Add a default admin User to a given databaseContext .</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00154">DatabaseSeeder.cs:154</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_models_1_1_user_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">Tgstation.Server.Host.Models.User</a></div><div class="ttdef"><b>Definition:</b> <a href="_user_8cs_source.html#l00012">User.cs:13</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_models_1_1_user_html_a4b139051d0d6db501e37590fa1eabf16"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16">Tgstation.Server.Host.Models.User.CanonicalizeName</a></div><div class="ttdeci">static string CanonicalizeName(string name)</div><div class="ttdoc">Change a UserName.Name into a CanonicalName.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_default_credentials_8cs_source.html#l00011">Tgstation.Server.Api.DefaultCredentials.AdminUserName</a>, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16">Tgstation.Server.Host.Models.User.CanonicalizeName()</a>, <a class="el" href="_database_seeder_8cs_source.html#l00154">Tgstation.Server.Host.Database.DatabaseSeeder.SeedAdminUser()</a>, and <a class="el" href="_i_database_context_8cs_source.html#l00021">Tgstation.Server.Host.Database.IDatabaseContext.Users</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00280">Tgstation.Server.Host.Database.DatabaseSeeder.ResetAdminPassword()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00198">Tgstation.Server.Host.Database.DatabaseSeeder.SanitizeDatabase()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1eed27ad5d706f6f3f4c691704205f67_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1eed27ad5d706f6f3f4c691704205f67_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1eed27ad5d706f6f3f4c691704205f67_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1eed27ad5d706f6f3f4c691704205f67_cgraph">
<area shape="rect" title="Get or create the admin User." alt="" coords="5,39,215,80"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16" title="Change a UserName.Name into a CanonicalName." alt="" coords="549,5,745,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a58329cfe5297b2569da770f7c05e1fbf" title="Add a default admin User to a given databaseContext ." alt="" coords="263,68,479,109"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#abd9cab598d35f6af8c789a1f01bba081" title="Add a given model &#160;to the the working set." alt="" coords="542,71,751,112"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430" title="Sets a User.PasswordHash for a given user ." alt="" coords="527,136,767,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1eed27ad5d706f6f3f4c691704205f67_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1eed27ad5d706f6f3f4c691704205f67_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1eed27ad5d706f6f3f4c691704205f67_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1eed27ad5d706f6f3f4c691704205f67_icgraph">
<area shape="rect" title="Get or create the admin User." alt="" coords="561,39,771,80"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#af844d41153f8a43c071bb6ec67445a1b" title="Changes the admin password in IDatabaseContext back to it&#39;s default, enables the account,..." alt="" coords="263,5,513,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1ed443f053ba4e1098f0e4099d23b774" title="Correct invalid database data caused by previous versions (NOT user fuckery)." alt="" coords="277,71,499,112"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a453f07e4addb58e08b4ce0ddfb84e357" title="Setup up a given databaseContext ." alt="" coords="5,39,215,80"/>
</map>
</div>

</div>
</div>
<a id="a453f07e4addb58e08b4ce0ddfb84e357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a453f07e4addb58e08b4ce0ddfb84e357">&#9670;&nbsp;</a></span>Initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task Tgstation.Server.Host.Database.DatabaseSeeder.Initialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a>&#160;</td>
          <td class="paramname"><em>databaseContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="namespace_tgstation_1_1_server_1_1_host_1_1_setup.html">Setup</a> up a given <em>databaseContext</em> . </p>

<p>Implements <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_seeder.html#a62bc67dd82ccf210c92c01966640cb64">Tgstation.Server.Host.Database.IDatabaseSeeder</a>.</p>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00105">105</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">if</span> (databaseContext == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(databaseContext));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a6c8e101a216a05b59a646260218b2467">databaseConfiguration</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html#a30f47f73075f305073ad72ef3ff44cd4">DropDatabase</a>)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">logger</a>.LogCritical(<span class="stringliteral">&quot;DropDatabase configuration option set! Dropping any existing database...&quot;</span>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                await databaseContext.Drop(cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            var wasEmpty = await databaseContext.Migrate(<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a2bc9f345004fe0cd972d9275d771b948">databaseLogger</a>, cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">if</span> (wasEmpty)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">logger</a>.LogInformation(<span class="stringliteral">&quot;Seeding database...&quot;</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                await <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a09fc7208df756283dd6b475cfe013151">SeedDatabase</a>(databaseContext, cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a6c8e101a216a05b59a646260218b2467">databaseConfiguration</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html#a90f97812f033dd9cc418ea1fcffe3ce0">ResetAdminPassword</a>)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">logger</a>.LogWarning(<span class="stringliteral">&quot;Enabling and resetting admin password due to configuration!&quot;</span>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    await <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#af844d41153f8a43c071bb6ec67445a1b">ResetAdminPassword</a>(databaseContext, cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                await <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1ed443f053ba4e1098f0e4099d23b774">SanitizeDatabase</a>(databaseContext, cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration_html_a30f47f73075f305073ad72ef3ff44cd4"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html#a30f47f73075f305073ad72ef3ff44cd4">Tgstation.Server.Host.Configuration.DatabaseConfiguration.DropDatabase</a></div><div class="ttdeci">bool DropDatabase</div><div class="ttdoc">If the database should be deleted on application startup. Should not be used in production!...</div><div class="ttdef"><b>Definition:</b> <a href="_database_configuration_8cs_source.html#l00035">DatabaseConfiguration.cs:35</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration_html_a90f97812f033dd9cc418ea1fcffe3ce0"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html#a90f97812f033dd9cc418ea1fcffe3ce0">Tgstation.Server.Host.Configuration.DatabaseConfiguration.ResetAdminPassword</a></div><div class="ttdeci">bool ResetAdminPassword</div><div class="ttdoc">If the admin user should be enabled and have it's password reset.</div><div class="ttdef"><b>Definition:</b> <a href="_database_configuration_8cs_source.html#l00025">DatabaseConfiguration.cs:25</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_a09fc7208df756283dd6b475cfe013151"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a09fc7208df756283dd6b475cfe013151">Tgstation.Server.Host.Database.DatabaseSeeder.SeedDatabase</a></div><div class="ttdeci">async Task SeedDatabase(IDatabaseContext databaseContext, CancellationToken cancellationToken)</div><div class="ttdoc">Initially seed a given databaseContext .</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00179">DatabaseSeeder.cs:179</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_a1ed443f053ba4e1098f0e4099d23b774"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1ed443f053ba4e1098f0e4099d23b774">Tgstation.Server.Host.Database.DatabaseSeeder.SanitizeDatabase</a></div><div class="ttdeci">async Task SanitizeDatabase(IDatabaseContext databaseContext, CancellationToken cancellationToken)</div><div class="ttdoc">Correct invalid database data caused by previous versions (NOT user fuckery).</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00198">DatabaseSeeder.cs:198</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_af844d41153f8a43c071bb6ec67445a1b"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#af844d41153f8a43c071bb6ec67445a1b">Tgstation.Server.Host.Database.DatabaseSeeder.ResetAdminPassword</a></div><div class="ttdeci">async Task ResetAdminPassword(IDatabaseContext databaseContext, CancellationToken cancellationToken)</div><div class="ttdoc">Changes the admin password in IDatabaseContext back to it's default, enables the account,...</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00280">DatabaseSeeder.cs:280</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_database_seeder_8cs_source.html#l00052">Tgstation.Server.Host.Database.DatabaseSeeder.databaseConfiguration</a>, <a class="el" href="_database_seeder_8cs_source.html#l00037">Tgstation.Server.Host.Database.DatabaseSeeder.databaseLogger</a>, <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a6216e8a817ab6700a155699bb8013584">Tgstation.Server.Host.Database.IDatabaseContext.Drop()</a>, <a class="el" href="_database_configuration_8cs_source.html#l00035">Tgstation.Server.Host.Configuration.DatabaseConfiguration.DropDatabase</a>, <a class="el" href="_database_seeder_8cs_source.html#l00042">Tgstation.Server.Host.Database.DatabaseSeeder.logger</a>, <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#ac03f819c07cb242b5257f5c158235b06">Tgstation.Server.Host.Database.IDatabaseContext.Migrate()</a>, <a class="el" href="_database_configuration_8cs_source.html#l00025">Tgstation.Server.Host.Configuration.DatabaseConfiguration.ResetAdminPassword</a>, <a class="el" href="_database_seeder_8cs_source.html#l00280">Tgstation.Server.Host.Database.DatabaseSeeder.ResetAdminPassword()</a>, <a class="el" href="_database_seeder_8cs_source.html#l00198">Tgstation.Server.Host.Database.DatabaseSeeder.SanitizeDatabase()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00179">Tgstation.Server.Host.Database.DatabaseSeeder.SeedDatabase()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a453f07e4addb58e08b4ce0ddfb84e357_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a453f07e4addb58e08b4ce0ddfb84e357_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a453f07e4addb58e08b4ce0ddfb84e357_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a453f07e4addb58e08b4ce0ddfb84e357_cgraph">
<area shape="rect" title="Setup up a given databaseContext ." alt="" coords="5,225,215,267"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a6216e8a817ab6700a155699bb8013584" title="Attempts to delete all tables and drop the database in use." alt="" coords="283,95,493,136"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#ac03f819c07cb242b5257f5c158235b06" title="Creates and migrates the IDatabaseContext." alt="" coords="283,160,493,201"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#af844d41153f8a43c071bb6ec67445a1b" title="Changes the admin password in IDatabaseContext back to it&#39;s default, enables the account,..." alt="" coords="263,291,513,332"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1ed443f053ba4e1098f0e4099d23b774" title="Correct invalid database data caused by previous versions (NOT user fuckery)." alt="" coords="277,225,499,267"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a09fc7208df756283dd6b475cfe013151" title="Initially seed a given databaseContext ." alt="" coords="283,381,493,423"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1eed27ad5d706f6f3f4c691704205f67" title="Get or create the admin User." alt="" coords="561,232,771,273"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430" title="Sets a User.PasswordHash for a given user ." alt="" coords="1089,272,1329,313"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a74e123c6393ad813f997c882a22b228e" title="Saves changes made to the IDatabaseContext." alt="" coords="561,349,771,391"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16" title="Change a UserName.Name into a CanonicalName." alt="" coords="1111,121,1307,163"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a58329cfe5297b2569da770f7c05e1fbf" title="Add a default admin User to a given databaseContext ." alt="" coords="822,239,1038,280"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#abd9cab598d35f6af8c789a1f01bba081" title="Add a given model &#160;to the the working set." alt="" coords="1105,193,1314,235"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#a05e77420e74de1e7739eadcd7c9c8070" title="Attach a given model &#160;to the the working set." alt="" coords="561,5,771,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#ad65df3157dcd8d5485b4564fa7f92798" title="Add a default system User to a given databaseContext ." alt="" coords="819,173,1041,215"/>
</map>
</div>

</div>
</div>
<a id="af844d41153f8a43c071bb6ec67445a1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af844d41153f8a43c071bb6ec67445a1b">&#9670;&nbsp;</a></span>ResetAdminPassword()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">async Task Tgstation.Server.Host.Database.DatabaseSeeder.ResetAdminPassword </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a>&#160;</td>
          <td class="paramname"><em>databaseContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Changes the admin password in <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html" title="Represents the database.">IDatabaseContext</a> back to it's default, enables the account, and gives it AdministrationRights.WriteUsers access. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">databaseContext</td><td>The <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html" title="Represents the database.">IDatabaseContext</a> to reset the admin password for.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task representing the running operation.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00280">280</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            var admin = await <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1eed27ad5d706f6f3f4c691704205f67">GetAdminUser</a>(databaseContext, cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">if</span> (admin != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                admin.Enabled = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="comment">// force the user out of any groups</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <span class="keywordflow">if</span> (admin.PermissionSet == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    admin.Group = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    admin.GroupId = <span class="keyword">null</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    admin.PermissionSet = <span class="keyword">new</span> <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_permission_set.html">PermissionSet</a></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                        <a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#af199a84ed6fe6ca557db9de91070ad79">InstanceManagerRights</a> = <a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#af199a84ed6fe6ca557db9de91070ad79">InstanceManagerRights</a>.None,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                        <a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#affda1440f9c5e2dfcca65138d2f89a21">AdministrationRights</a> = <a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#affda1440f9c5e2dfcca65138d2f89a21">AdministrationRights</a>.WriteUsers,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    };</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    admin.PermissionSet.<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_permission_set.html#a3e48853d50e80f62e6a0310e0be733f9">AdministrationRights</a> |= <a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#affda1440f9c5e2dfcca65138d2f89a21">AdministrationRights</a>.WriteUsers;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a88f644df987dce53ffa2e26a763f5974">cryptographySuite</a>.<a class="code" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430">SetUserPassword</a>(admin, <a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html">DefaultCredentials</a>.<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html#a7c4bd40bf42d05fe66169093d3bfc172">DefaultAdminUserPassword</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            await databaseContext.Save(cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_default_credentials_html_a7c4bd40bf42d05fe66169093d3bfc172"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html#a7c4bd40bf42d05fe66169093d3bfc172">Tgstation.Server.Api.DefaultCredentials.DefaultAdminUserPassword</a></div><div class="ttdeci">static readonly string DefaultAdminUserPassword</div><div class="ttdoc">The default admin password.</div><div class="ttdef"><b>Definition:</b> <a href="_default_credentials_8cs_source.html#l00016">DefaultCredentials.cs:16</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_models_1_1_permission_set_html_a3e48853d50e80f62e6a0310e0be733f9"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_permission_set.html#a3e48853d50e80f62e6a0310e0be733f9">Tgstation.Server.Api.Models.PermissionSet.AdministrationRights</a></div><div class="ttdeci">AdministrationRights? AdministrationRights</div><div class="ttdoc">The Rights.AdministrationRights for the user.</div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_api_2_models_2_permission_set_8cs_source.html#l00024">PermissionSet.cs:24</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_a1eed27ad5d706f6f3f4c691704205f67"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1eed27ad5d706f6f3f4c691704205f67">Tgstation.Server.Host.Database.DatabaseSeeder.GetAdminUser</a></div><div class="ttdeci">async Task&lt; User &gt; GetAdminUser(IDatabaseContext databaseContext, CancellationToken cancellationToken)</div><div class="ttdoc">Get or create the admin User.</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00312">DatabaseSeeder.cs:312</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_models_1_1_permission_set_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_permission_set.html">Tgstation.Server.Host.Models.PermissionSet</a></div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_2_models_2_permission_set_8cs_source.html#l00006">PermissionSet.cs:7</a></div></div>
<div class="ttc" id="ainterface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite_html_aeab60aa0a0ee2cb5e2ad5dbde1983430"><div class="ttname"><a href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430">Tgstation.Server.Host.Security.ICryptographySuite.SetUserPassword</a></div><div class="ttdeci">void SetUserPassword(User user, string newPassword, bool newUser)</div><div class="ttdoc">Sets a User.PasswordHash for a given user .</div></div>
<div class="ttc" id="anamespace_tgstation_1_1_server_1_1_api_1_1_rights_html_af199a84ed6fe6ca557db9de91070ad79"><div class="ttname"><a href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#af199a84ed6fe6ca557db9de91070ad79">Tgstation.Server.Api.Rights.InstanceManagerRights</a></div><div class="ttdeci">InstanceManagerRights</div><div class="ttdoc">Rights for managing Models.Instances.</div><div class="ttdef"><b>Definition:</b> <a href="_instance_manager_rights_8cs_source.html#l00009">InstanceManagerRights.cs:10</a></div></div>
<div class="ttc" id="anamespace_tgstation_1_1_server_1_1_api_1_1_rights_html_affda1440f9c5e2dfcca65138d2f89a21"><div class="ttname"><a href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#affda1440f9c5e2dfcca65138d2f89a21">Tgstation.Server.Api.Rights.AdministrationRights</a></div><div class="ttdeci">AdministrationRights</div><div class="ttdoc">Administration rights for the server.</div><div class="ttdef"><b>Definition:</b> <a href="_administration_rights_8cs_source.html#l00009">AdministrationRights.cs:10</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_tgstation_8_server_8_api_2_models_2_permission_set_8cs_source.html#l00024">Tgstation.Server.Api.Models.PermissionSet.AdministrationRights</a>, <a class="el" href="_database_seeder_8cs_source.html#l00027">Tgstation.Server.Host.Database.DatabaseSeeder.cryptographySuite</a>, <a class="el" href="_default_credentials_8cs_source.html#l00016">Tgstation.Server.Api.DefaultCredentials.DefaultAdminUserPassword</a>, <a class="el" href="_database_seeder_8cs_source.html#l00312">Tgstation.Server.Host.Database.DatabaseSeeder.GetAdminUser()</a>, <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a74e123c6393ad813f997c882a22b228e">Tgstation.Server.Host.Database.IDatabaseContext.Save()</a>, and <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430">Tgstation.Server.Host.Security.ICryptographySuite.SetUserPassword()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00105">Tgstation.Server.Host.Database.DatabaseSeeder.Initialize()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_af844d41153f8a43c071bb6ec67445a1b_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_af844d41153f8a43c071bb6ec67445a1b_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_af844d41153f8a43c071bb6ec67445a1b_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_af844d41153f8a43c071bb6ec67445a1b_cgraph">
<area shape="rect" title="Changes the admin password in IDatabaseContext back to it&#39;s default, enables the account,..." alt="" coords="5,132,256,173"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1eed27ad5d706f6f3f4c691704205f67" title="Get or create the admin User." alt="" coords="304,71,513,112"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430" title="Sets a User.PasswordHash for a given user ." alt="" coords="825,136,1065,177"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a74e123c6393ad813f997c882a22b228e" title="Saves changes made to the IDatabaseContext." alt="" coords="304,191,513,232"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16" title="Change a UserName.Name into a CanonicalName." alt="" coords="847,5,1043,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a58329cfe5297b2569da770f7c05e1fbf" title="Add a default admin User to a given databaseContext ." alt="" coords="561,71,777,112"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#abd9cab598d35f6af8c789a1f01bba081" title="Add a given model &#160;to the the working set." alt="" coords="841,71,1050,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_af844d41153f8a43c071bb6ec67445a1b_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_af844d41153f8a43c071bb6ec67445a1b_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_af844d41153f8a43c071bb6ec67445a1b_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_af844d41153f8a43c071bb6ec67445a1b_icgraph">
<area shape="rect" title="Changes the admin password in IDatabaseContext back to it&#39;s default, enables the account,..." alt="" coords="263,5,513,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a453f07e4addb58e08b4ce0ddfb84e357" title="Setup up a given databaseContext ." alt="" coords="5,5,215,47"/>
</map>
</div>

</div>
</div>
<a id="a1ed443f053ba4e1098f0e4099d23b774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ed443f053ba4e1098f0e4099d23b774">&#9670;&nbsp;</a></span>SanitizeDatabase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">async Task Tgstation.Server.Host.Database.DatabaseSeeder.SanitizeDatabase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a>&#160;</td>
          <td class="paramname"><em>databaseContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Correct invalid database data caused by previous versions (NOT user fuckery). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">databaseContext</td><td>The <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html" title="Represents the database.">IDatabaseContext</a> to sanitize.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task representing the running operation.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00198">198</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            var admin = await <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1eed27ad5d706f6f3f4c691704205f67">GetAdminUser</a>(databaseContext, cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">if</span> (admin != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                <span class="keywordflow">if</span> (admin.PermissionSet != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    <span class="comment">// Fix the issue with ulong enums</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    <span class="comment">// https://github.com/tgstation/tgstation-server/commit/db341d43b3dab74fe3681f5172ca9bfeaafa6b6d#diff-09f06ec4584665cf89bb77b97f5ccfb9R36-R39</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    <span class="comment">// https://github.com/JamesNK/Newtonsoft.Json/issues/2301</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    admin.PermissionSet.AdministrationRights &amp;= <a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_rights_1_1_rights_helper.html">RightsHelper</a>.AllRights&lt;<a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#affda1440f9c5e2dfcca65138d2f89a21">AdministrationRights</a>&gt;();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    admin.PermissionSet.InstanceManagerRights &amp;= <a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_rights_1_1_rights_helper.html">RightsHelper</a>.AllRights&lt;<a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#af199a84ed6fe6ca557db9de91070ad79">InstanceManagerRights</a>&gt;();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">if</span> (admin.CreatedBy == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    var tgsUser = await databaseContext</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                        .Users</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        .AsQueryable()</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                        .Where(x =&gt; x.CanonicalName == <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16">CanonicalizeName</a>(<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a2e68345f5d52c8ba64dca5ec061d029d">TgsSystemUserName</a>))</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                        .FirstOrDefaultAsync(cancellationToken)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                        .ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    <span class="keywordflow">if</span> (tgsUser != <span class="keyword">null</span>)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                        <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">logger</a>.LogError(</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                            <span class="stringliteral">&quot;A user named TGS (Canonically) exists but isn&#39;t marked as the admin&#39;s creator. This may be because it was created manually. This user is going to be adapted to use as the starter of system jobs.&quot;</span>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    tgsUser = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#ad65df3157dcd8d5485b4564fa7f92798">SeedSystemUser</a>(databaseContext, tgsUser);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    admin.CreatedBy = tgsUser;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a9b30ce06ad99c07d9405020656cc3a1d">platformIdentifier</a>.<a class="code" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_platform_identifier.html#aa9bf3bd1082b7178f58cb1f36839550e">IsWindows</a>)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="comment">// normalize backslashes to forward slashes</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                var allInstances = await databaseContext</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                    .Instances</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    .AsQueryable()</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    .ToListAsync(cancellationToken)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    .ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordflow">foreach</span> (var instance <span class="keywordflow">in</span> allInstances)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    instance.Path = instance.Path.Replace(<span class="charliteral">&#39;\\&#39;</span>, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a51341ea00d7cfc1eead8b52235e76257">generalConfiguration</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html#a51431792c5538add1bdad55e499a4971">ByondTopicTimeout</a> != 0)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                var ids = await databaseContext</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    .DreamDaemonSettings</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    .AsQueryable()</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    .Where(x =&gt; x.TopicRequestTimeout == 0)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    .Select(x =&gt; x.Id)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    .ToListAsync(cancellationToken)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    .ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                var rowsUpdated = ids.Count;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="keywordflow">foreach</span> (var <span class="keywordtype">id</span> <span class="keywordflow">in</span> ids)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    var newDDSettings = <span class="keyword">new</span> <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_dream_daemon_settings.html">DreamDaemonSettings</a></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                    {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                        Id = id,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    };</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                    databaseContext.DreamDaemonSettings.Attach(newDDSettings);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    newDDSettings.<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_internal_1_1_dream_daemon_launch_parameters.html#a5e172ad3abdcc1f6a0f24cdf08646d0a">TopicRequestTimeout</a> = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a51341ea00d7cfc1eead8b52235e76257">generalConfiguration</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html#a51431792c5538add1bdad55e499a4971">ByondTopicTimeout</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordflow">if</span> (rowsUpdated &gt; 0)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#aaf6976bc08dbb6209b8ca16509604a09">logger</a>.LogInformation(</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        <span class="stringliteral">&quot;Updated {0} instances to use database backed BYOND topic timeouts from configuration setting of {1}&quot;</span>,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                        rowsUpdated,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                        <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a51341ea00d7cfc1eead8b52235e76257">generalConfiguration</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html#a51431792c5538add1bdad55e499a4971">ByondTopicTimeout</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            await databaseContext.Save(cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_models_1_1_internal_1_1_dream_daemon_launch_parameters_html_a5e172ad3abdcc1f6a0f24cdf08646d0a"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_internal_1_1_dream_daemon_launch_parameters.html#a5e172ad3abdcc1f6a0f24cdf08646d0a">Tgstation.Server.Api.Models.Internal.DreamDaemonLaunchParameters.TopicRequestTimeout</a></div><div class="ttdeci">uint? TopicRequestTimeout</div><div class="ttdoc">The timeout for sending and receiving BYOND topics in milliseconds.</div><div class="ttdef"><b>Definition:</b> <a href="_dream_daemon_launch_parameters_8cs_source.html#l00063">DreamDaemonLaunchParameters.cs:63</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_rights_1_1_rights_helper_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_rights_1_1_rights_helper.html">Tgstation.Server.Api.Rights.RightsHelper</a></div><div class="ttdoc">Helper for RightsTypes.</div><div class="ttdef"><b>Definition:</b> <a href="_rights_helper_8cs_source.html#l00010">RightsHelper.cs:11</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration_html_a51431792c5538add1bdad55e499a4971"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html#a51431792c5538add1bdad55e499a4971">Tgstation.Server.Host.Configuration.GeneralConfiguration.ByondTopicTimeout</a></div><div class="ttdeci">uint ByondTopicTimeout</div><div class="ttdoc">The timeout in milliseconds for sending and receiving topics to/from DreamDaemon. Note that a single ...</div><div class="ttdef"><b>Definition:</b> <a href="_general_configuration_8cs_source.html#l00092">GeneralConfiguration.cs:92</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_html_ad65df3157dcd8d5485b4564fa7f92798"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#ad65df3157dcd8d5485b4564fa7f92798">Tgstation.Server.Host.Database.DatabaseSeeder.SeedSystemUser</a></div><div class="ttdeci">static User SeedSystemUser(IDatabaseContext databaseContext, User tgsUser=null)</div><div class="ttdoc">Add a default system User to a given databaseContext .</div><div class="ttdef"><b>Definition:</b> <a href="_database_seeder_8cs_source.html#l00060">DatabaseSeeder.cs:60</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_models_1_1_dream_daemon_settings_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_dream_daemon_settings.html">Tgstation.Server.Host.Models.DreamDaemonSettings</a></div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_2_models_2_dream_daemon_settings_8cs_source.html#l00006">DreamDaemonSettings.cs:7</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_models_1_1_user_html_a2e68345f5d52c8ba64dca5ec061d029d"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a2e68345f5d52c8ba64dca5ec061d029d">Tgstation.Server.Host.Models.User.TgsSystemUserName</a></div><div class="ttdeci">const string TgsSystemUserName</div><div class="ttdoc">Username used when creating jobs automatically.</div><div class="ttdef"><b>Definition:</b> <a href="_user_8cs_source.html#l00017">User.cs:17</a></div></div>
<div class="ttc" id="ainterface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_platform_identifier_html_aa9bf3bd1082b7178f58cb1f36839550e"><div class="ttname"><a href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_platform_identifier.html#aa9bf3bd1082b7178f58cb1f36839550e">Tgstation.Server.Host.System.IPlatformIdentifier.IsWindows</a></div><div class="ttdeci">bool IsWindows</div><div class="ttdoc">If the current platform is a Windows platform.</div><div class="ttdef"><b>Definition:</b> <a href="_i_platform_identifier_8cs_source.html#l00011">IPlatformIdentifier.cs:11</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#a05e77420e74de1e7739eadcd7c9c8070">Tgstation.Server.Host.Database.IDatabaseCollection&lt; TModel &gt;.Attach()</a>, <a class="el" href="_general_configuration_8cs_source.html#l00092">Tgstation.Server.Host.Configuration.GeneralConfiguration.ByondTopicTimeout</a>, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16">Tgstation.Server.Host.Models.User.CanonicalizeName()</a>, <a class="el" href="_i_database_context_8cs_source.html#l00056">Tgstation.Server.Host.Database.IDatabaseContext.DreamDaemonSettings</a>, <a class="el" href="_database_seeder_8cs_source.html#l00047">Tgstation.Server.Host.Database.DatabaseSeeder.generalConfiguration</a>, <a class="el" href="_database_seeder_8cs_source.html#l00312">Tgstation.Server.Host.Database.DatabaseSeeder.GetAdminUser()</a>, <a class="el" href="_i_database_context_8cs_source.html#l00026">Tgstation.Server.Host.Database.IDatabaseContext.Instances</a>, <a class="el" href="_i_platform_identifier_8cs_source.html#l00011">Tgstation.Server.Host.System.IPlatformIdentifier.IsWindows</a>, <a class="el" href="_database_seeder_8cs_source.html#l00042">Tgstation.Server.Host.Database.DatabaseSeeder.logger</a>, <a class="el" href="_database_seeder_8cs_source.html#l00032">Tgstation.Server.Host.Database.DatabaseSeeder.platformIdentifier</a>, <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a74e123c6393ad813f997c882a22b228e">Tgstation.Server.Host.Database.IDatabaseContext.Save()</a>, <a class="el" href="_database_seeder_8cs_source.html#l00060">Tgstation.Server.Host.Database.DatabaseSeeder.SeedSystemUser()</a>, <a class="el" href="_user_8cs_source.html#l00017">Tgstation.Server.Host.Models.User.TgsSystemUserName</a>, and <a class="el" href="_i_database_context_8cs_source.html#l00021">Tgstation.Server.Host.Database.IDatabaseContext.Users</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00105">Tgstation.Server.Host.Database.DatabaseSeeder.Initialize()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1ed443f053ba4e1098f0e4099d23b774_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1ed443f053ba4e1098f0e4099d23b774_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1ed443f053ba4e1098f0e4099d23b774_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1ed443f053ba4e1098f0e4099d23b774_cgraph">
<area shape="rect" title="Correct invalid database data caused by previous versions (NOT user fuckery)." alt="" coords="5,123,228,164"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#a05e77420e74de1e7739eadcd7c9c8070" title="Attach a given model &#160;to the the working set." alt="" coords="276,5,485,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16" title="Change a UserName.Name into a CanonicalName." alt="" coords="826,108,1022,149"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1eed27ad5d706f6f3f4c691704205f67" title="Get or create the admin User." alt="" coords="276,123,485,164"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a74e123c6393ad813f997c882a22b228e" title="Saves changes made to the IDatabaseContext." alt="" coords="276,240,485,281"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#ad65df3157dcd8d5485b4564fa7f92798" title="Add a default system User to a given databaseContext ." alt="" coords="533,239,756,280"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a58329cfe5297b2569da770f7c05e1fbf" title="Add a default admin User to a given databaseContext ." alt="" coords="537,173,753,215"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#abd9cab598d35f6af8c789a1f01bba081" title="Add a given model &#160;to the the working set." alt="" coords="819,239,1029,280"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430" title="Sets a User.PasswordHash for a given user ." alt="" coords="804,173,1044,215"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1ed443f053ba4e1098f0e4099d23b774_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1ed443f053ba4e1098f0e4099d23b774_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1ed443f053ba4e1098f0e4099d23b774_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a1ed443f053ba4e1098f0e4099d23b774_icgraph">
<area shape="rect" title="Correct invalid database data caused by previous versions (NOT user fuckery)." alt="" coords="263,5,485,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a453f07e4addb58e08b4ce0ddfb84e357" title="Setup up a given databaseContext ." alt="" coords="5,5,215,47"/>
</map>
</div>

</div>
</div>
<a id="a58329cfe5297b2569da770f7c05e1fbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58329cfe5297b2569da770f7c05e1fbf">&#9670;&nbsp;</a></span>SeedAdminUser()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a> Tgstation.Server.Host.Database.DatabaseSeeder.SeedAdminUser </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a>&#160;</td>
          <td class="paramname"><em>databaseContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a default admin User to a given <em>databaseContext</em> . </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">databaseContext</td><td>The <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html" title="Represents the database.">IDatabaseContext</a> to add an admin User to.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The created admin User.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00154">154</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            var admin = <span class="keyword">new</span> <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_permission_set.html">PermissionSet</a> = <span class="keyword">new</span> <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_permission_set.html">PermissionSet</a></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    <a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#affda1440f9c5e2dfcca65138d2f89a21">AdministrationRights</a> = <a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_rights_1_1_rights_helper.html">RightsHelper</a>.AllRights&lt;<a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#affda1440f9c5e2dfcca65138d2f89a21">AdministrationRights</a>&gt;(),</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    <a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#af199a84ed6fe6ca557db9de91070ad79">InstanceManagerRights</a> = <a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_rights_1_1_rights_helper.html">RightsHelper</a>.AllRights&lt;<a class="code" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#af199a84ed6fe6ca557db9de91070ad79">InstanceManagerRights</a>&gt;(),</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                },</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                CreatedAt = DateTimeOffset.UtcNow,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                Name = <a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html">DefaultCredentials</a>.<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html#a92e853a434de557956993046d1b364bb">AdminUserName</a>,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                CanonicalName = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16">CanonicalizeName</a>(<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html">DefaultCredentials</a>.<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html#a92e853a434de557956993046d1b364bb">AdminUserName</a>),</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                Enabled = <span class="keyword">true</span>,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            };</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a88f644df987dce53ffa2e26a763f5974">cryptographySuite</a>.<a class="code" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430">SetUserPassword</a>(admin, <a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html">DefaultCredentials</a>.<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_default_credentials.html#a7c4bd40bf42d05fe66169093d3bfc172">DefaultAdminUserPassword</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            databaseContext.Users.Add(admin);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">return</span> admin;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#abd9cab598d35f6af8c789a1f01bba081">Tgstation.Server.Host.Database.IDatabaseCollection&lt; TModel &gt;.Add()</a>, <a class="el" href="_default_credentials_8cs_source.html#l00011">Tgstation.Server.Api.DefaultCredentials.AdminUserName</a>, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16">Tgstation.Server.Host.Models.User.CanonicalizeName()</a>, <a class="el" href="_database_seeder_8cs_source.html#l00027">Tgstation.Server.Host.Database.DatabaseSeeder.cryptographySuite</a>, <a class="el" href="_default_credentials_8cs_source.html#l00016">Tgstation.Server.Api.DefaultCredentials.DefaultAdminUserPassword</a>, <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430">Tgstation.Server.Host.Security.ICryptographySuite.SetUserPassword()</a>, and <a class="el" href="_i_database_context_8cs_source.html#l00021">Tgstation.Server.Host.Database.IDatabaseContext.Users</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00312">Tgstation.Server.Host.Database.DatabaseSeeder.GetAdminUser()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00179">Tgstation.Server.Host.Database.DatabaseSeeder.SeedDatabase()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a58329cfe5297b2569da770f7c05e1fbf_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a58329cfe5297b2569da770f7c05e1fbf_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a58329cfe5297b2569da770f7c05e1fbf_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a58329cfe5297b2569da770f7c05e1fbf_cgraph">
<area shape="rect" title="Add a default admin User to a given databaseContext ." alt="" coords="5,71,221,112"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#abd9cab598d35f6af8c789a1f01bba081" title="Add a given model &#160;to the the working set." alt="" coords="285,5,494,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16" title="Change a UserName.Name into a CanonicalName." alt="" coords="291,71,487,112"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430" title="Sets a User.PasswordHash for a given user ." alt="" coords="269,136,509,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a58329cfe5297b2569da770f7c05e1fbf_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a58329cfe5297b2569da770f7c05e1fbf_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a58329cfe5297b2569da770f7c05e1fbf_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a58329cfe5297b2569da770f7c05e1fbf_icgraph">
<area shape="rect" title="Add a default admin User to a given databaseContext ." alt="" coords="819,97,1035,139"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1eed27ad5d706f6f3f4c691704205f67" title="Get or create the admin User." alt="" coords="561,64,771,105"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a09fc7208df756283dd6b475cfe013151" title="Initially seed a given databaseContext ." alt="" coords="561,129,771,171"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#af844d41153f8a43c071bb6ec67445a1b" title="Changes the admin password in IDatabaseContext back to it&#39;s default, enables the account,..." alt="" coords="263,5,513,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1ed443f053ba4e1098f0e4099d23b774" title="Correct invalid database data caused by previous versions (NOT user fuckery)." alt="" coords="277,71,499,112"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a453f07e4addb58e08b4ce0ddfb84e357" title="Setup up a given databaseContext ." alt="" coords="5,71,215,112"/>
</map>
</div>

</div>
</div>
<a id="a09fc7208df756283dd6b475cfe013151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09fc7208df756283dd6b475cfe013151">&#9670;&nbsp;</a></span>SeedDatabase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">async Task Tgstation.Server.Host.Database.DatabaseSeeder.SeedDatabase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a>&#160;</td>
          <td class="paramname"><em>databaseContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initially seed a given <em>databaseContext</em> . </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">databaseContext</td><td>The <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html" title="Represents the database.">IDatabaseContext</a> to seed.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task representing the running operation.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00179">179</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            var adminUser = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a58329cfe5297b2569da770f7c05e1fbf">SeedAdminUser</a>(databaseContext);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="comment">// Save here because we want admin to have the first DB Id</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="comment">// The system user isn&#39;t shown in the API except by references in the admin user and jobs</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            await databaseContext.Save(cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            var tgsUser = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#ad65df3157dcd8d5485b4564fa7f92798">SeedSystemUser</a>(databaseContext);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            adminUser.CreatedBy = tgsUser;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            await databaseContext.Save(cancellationToken).ConfigureAwait(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a74e123c6393ad813f997c882a22b228e">Tgstation.Server.Host.Database.IDatabaseContext.Save()</a>, <a class="el" href="_database_seeder_8cs_source.html#l00154">Tgstation.Server.Host.Database.DatabaseSeeder.SeedAdminUser()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00060">Tgstation.Server.Host.Database.DatabaseSeeder.SeedSystemUser()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00105">Tgstation.Server.Host.Database.DatabaseSeeder.Initialize()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a09fc7208df756283dd6b475cfe013151_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a09fc7208df756283dd6b475cfe013151_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a09fc7208df756283dd6b475cfe013151_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a09fc7208df756283dd6b475cfe013151_cgraph">
<area shape="rect" title="Initially seed a given databaseContext ." alt="" coords="5,71,215,112"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html#a74e123c6393ad813f997c882a22b228e" title="Saves changes made to the IDatabaseContext." alt="" coords="269,5,479,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a58329cfe5297b2569da770f7c05e1fbf" title="Add a default admin User to a given databaseContext ." alt="" coords="266,136,482,177"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#ad65df3157dcd8d5485b4564fa7f92798" title="Add a default system User to a given databaseContext ." alt="" coords="263,71,485,112"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#abd9cab598d35f6af8c789a1f01bba081" title="Add a given model &#160;to the the working set." alt="" coords="549,136,758,177"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16" title="Change a UserName.Name into a CanonicalName." alt="" coords="555,71,751,112"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html#aeab60aa0a0ee2cb5e2ad5dbde1983430" title="Sets a User.PasswordHash for a given user ." alt="" coords="533,201,773,243"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a09fc7208df756283dd6b475cfe013151_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a09fc7208df756283dd6b475cfe013151_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a09fc7208df756283dd6b475cfe013151_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_a09fc7208df756283dd6b475cfe013151_icgraph">
<area shape="rect" title="Initially seed a given databaseContext ." alt="" coords="263,5,472,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a453f07e4addb58e08b4ce0ddfb84e357" title="Setup up a given databaseContext ." alt="" coords="5,5,215,47"/>
</map>
</div>

</div>
</div>
<a id="ad65df3157dcd8d5485b4564fa7f92798"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad65df3157dcd8d5485b4564fa7f92798">&#9670;&nbsp;</a></span>SeedSystemUser()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a> Tgstation.Server.Host.Database.DatabaseSeeder.SeedSystemUser </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html">IDatabaseContext</a>&#160;</td>
          <td class="paramname"><em>databaseContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>&#160;</td>
          <td class="paramname"><em>tgsUser</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a default system User to a given <em>databaseContext</em> . </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">databaseContext</td><td>The <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html" title="Represents the database.">IDatabaseContext</a> to add a system User to.</td></tr>
    <tr><td class="paramname">tgsUser</td><td>An existing User, if any.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The created system User.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00060">60</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="keywordtype">bool</span> alreadyExists = tgsUser != <span class="keyword">null</span>;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            tgsUser ??= <span class="keyword">new</span> <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>()</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                CreatedAt = DateTimeOffset.UtcNow,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                CanonicalName = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16">CanonicalizeName</a>(<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a2e68345f5d52c8ba64dca5ec061d029d">TgsSystemUserName</a>),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            };</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="comment">// intentionally not giving a group or permissionset</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            tgsUser.<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_user_name.html#a74805e22cab51569d1d1aa098d62c9d3">Name</a> = <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html">User</a>.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a2e68345f5d52c8ba64dca5ec061d029d">TgsSystemUserName</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            tgsUser.<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#ab5648b7f95630ff37ad8b0ddd72c1f54">PasswordHash</a> = <span class="stringliteral">&quot;_&quot;</span>; <span class="comment">// This can&#39;t be hashed</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            tgsUser.<a class="code" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_internal_1_1_user_model_base.html#a442b355a92704a9cbf29edaafd7975ed">Enabled</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">if</span> (!alreadyExists)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                databaseContext.Users.Add(tgsUser);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordflow">return</span> tgsUser;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_models_1_1_internal_1_1_user_model_base_html_a442b355a92704a9cbf29edaafd7975ed"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_internal_1_1_user_model_base.html#a442b355a92704a9cbf29edaafd7975ed">Tgstation.Server.Api.Models.Internal.UserModelBase.Enabled</a></div><div class="ttdeci">bool? Enabled</div><div class="ttdoc">If the UserModelBase is enabled since users cannot be deleted. System users cannot be disabled.</div><div class="ttdef"><b>Definition:</b> <a href="_user_model_base_8cs_source.html#l00015">UserModelBase.cs:15</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_models_1_1_user_name_html_a74805e22cab51569d1d1aa098d62c9d3"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_user_name.html#a74805e22cab51569d1d1aa098d62c9d3">Tgstation.Server.Api.Models.UserName.Name</a></div><div class="ttdeci">override? string Name</div><div class="ttdef"><b>Definition:</b> <a href="_user_name_8cs_source.html#l00010">UserName.cs:11</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_models_1_1_user_html_ab5648b7f95630ff37ad8b0ddd72c1f54"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#ab5648b7f95630ff37ad8b0ddd72c1f54">Tgstation.Server.Host.Models.User.PasswordHash</a></div><div class="ttdeci">string PasswordHash</div><div class="ttdoc">The hash of the user's password.</div><div class="ttdef"><b>Definition:</b> <a href="_user_8cs_source.html#l00022">User.cs:22</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#abd9cab598d35f6af8c789a1f01bba081">Tgstation.Server.Host.Database.IDatabaseCollection&lt; TModel &gt;.Add()</a>, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16">Tgstation.Server.Host.Models.User.CanonicalizeName()</a>, <a class="el" href="_user_8cs_source.html#l00017">Tgstation.Server.Host.Models.User.TgsSystemUserName</a>, and <a class="el" href="_i_database_context_8cs_source.html#l00021">Tgstation.Server.Host.Database.IDatabaseContext.Users</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00198">Tgstation.Server.Host.Database.DatabaseSeeder.SanitizeDatabase()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00179">Tgstation.Server.Host.Database.DatabaseSeeder.SeedDatabase()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ad65df3157dcd8d5485b4564fa7f92798_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ad65df3157dcd8d5485b4564fa7f92798_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ad65df3157dcd8d5485b4564fa7f92798_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ad65df3157dcd8d5485b4564fa7f92798_cgraph">
<area shape="rect" title="Add a default system User to a given databaseContext ." alt="" coords="5,39,228,80"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_collection.html#abd9cab598d35f6af8c789a1f01bba081" title="Add a given model &#160;to the the working set." alt="" coords="276,5,485,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_user.html#a4b139051d0d6db501e37590fa1eabf16" title="Change a UserName.Name into a CanonicalName." alt="" coords="283,71,479,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ad65df3157dcd8d5485b4564fa7f92798_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ad65df3157dcd8d5485b4564fa7f92798_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ad65df3157dcd8d5485b4564fa7f92798_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder_ad65df3157dcd8d5485b4564fa7f92798_icgraph">
<area shape="rect" title="Add a default system User to a given databaseContext ." alt="" coords="533,39,756,80"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a1ed443f053ba4e1098f0e4099d23b774" title="Correct invalid database data caused by previous versions (NOT user fuckery)." alt="" coords="263,5,485,47"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a09fc7208df756283dd6b475cfe013151" title="Initially seed a given databaseContext ." alt="" coords="269,71,479,112"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html#a453f07e4addb58e08b4ce0ddfb84e357" title="Setup up a given databaseContext ." alt="" coords="5,39,215,80"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a88f644df987dce53ffa2e26a763f5974"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88f644df987dce53ffa2e26a763f5974">&#9670;&nbsp;</a></span>cryptographySuite</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_security_1_1_i_cryptography_suite.html">ICryptographySuite</a> Tgstation.Server.Host.Database.DatabaseSeeder.cryptographySuite</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The ICryptographySuite for the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>. </p>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00027">27</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00088">Tgstation.Server.Host.Database.DatabaseSeeder.DatabaseSeeder()</a>, <a class="el" href="_database_seeder_8cs_source.html#l00280">Tgstation.Server.Host.Database.DatabaseSeeder.ResetAdminPassword()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00154">Tgstation.Server.Host.Database.DatabaseSeeder.SeedAdminUser()</a>.</p>

</div>
</div>
<a id="a6c8e101a216a05b59a646260218b2467"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c8e101a216a05b59a646260218b2467">&#9670;&nbsp;</a></span>databaseConfiguration</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_database_configuration.html">DatabaseConfiguration</a> Tgstation.Server.Host.Database.DatabaseSeeder.databaseConfiguration</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The DatabaseConfiguration for the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>. </p>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00052">52</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00088">Tgstation.Server.Host.Database.DatabaseSeeder.DatabaseSeeder()</a>, <a class="el" href="_database_seeder_8cs_source.html#l00135">Tgstation.Server.Host.Database.DatabaseSeeder.Downgrade()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00105">Tgstation.Server.Host.Database.DatabaseSeeder.Initialize()</a>.</p>

</div>
</div>
<a id="a2bc9f345004fe0cd972d9275d771b948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bc9f345004fe0cd972d9275d771b948">&#9670;&nbsp;</a></span>databaseLogger</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly ILogger&lt;<a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_context.html">DatabaseContext</a>&gt; Tgstation.Server.Host.Database.DatabaseSeeder.databaseLogger</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The ILogger used for <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_database_1_1_i_database_context.html" title="Represents the database.">IDatabaseContext</a>s. </p>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00037">37</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00088">Tgstation.Server.Host.Database.DatabaseSeeder.DatabaseSeeder()</a>, <a class="el" href="_database_seeder_8cs_source.html#l00135">Tgstation.Server.Host.Database.DatabaseSeeder.Downgrade()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00105">Tgstation.Server.Host.Database.DatabaseSeeder.Initialize()</a>.</p>

</div>
</div>
<a id="a51341ea00d7cfc1eead8b52235e76257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51341ea00d7cfc1eead8b52235e76257">&#9670;&nbsp;</a></span>generalConfiguration</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a> Tgstation.Server.Host.Database.DatabaseSeeder.generalConfiguration</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The GeneralConfiguration for the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>. </p>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00047">47</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00088">Tgstation.Server.Host.Database.DatabaseSeeder.DatabaseSeeder()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00198">Tgstation.Server.Host.Database.DatabaseSeeder.SanitizeDatabase()</a>.</p>

</div>
</div>
<a id="aaf6976bc08dbb6209b8ca16509604a09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf6976bc08dbb6209b8ca16509604a09">&#9670;&nbsp;</a></span>logger</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly ILogger&lt;<a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>&gt; Tgstation.Server.Host.Database.DatabaseSeeder.logger</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The ILogger for the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>. </p>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00042">42</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00088">Tgstation.Server.Host.Database.DatabaseSeeder.DatabaseSeeder()</a>, <a class="el" href="_database_seeder_8cs_source.html#l00105">Tgstation.Server.Host.Database.DatabaseSeeder.Initialize()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00198">Tgstation.Server.Host.Database.DatabaseSeeder.SanitizeDatabase()</a>.</p>

</div>
</div>
<a id="a9b30ce06ad99c07d9405020656cc3a1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b30ce06ad99c07d9405020656cc3a1d">&#9670;&nbsp;</a></span>platformIdentifier</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_platform_identifier.html">IPlatformIdentifier</a> Tgstation.Server.Host.Database.DatabaseSeeder.platformIdentifier</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The IPlatformIdentifier for the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_database_1_1_database_seeder.html">DatabaseSeeder</a>. </p>

<p class="definition">Definition at line <a class="el" href="_database_seeder_8cs_source.html#l00032">32</a> of file <a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_database_seeder_8cs_source.html#l00088">Tgstation.Server.Host.Database.DatabaseSeeder.DatabaseSeeder()</a>, and <a class="el" href="_database_seeder_8cs_source.html#l00198">Tgstation.Server.Host.Database.DatabaseSeeder.SanitizeDatabase()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/Tgstation.Server.Host/Database/<a class="el" href="_database_seeder_8cs_source.html">DatabaseSeeder.cs</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
